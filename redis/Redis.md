
# Remote dictionary server

줄여서 Redis

고성능 키-값 유형의 인메모리 NoSQL.

[[NoSQL]]에서 설명한 유형중 키-값에 해당하며

키-값은 가장 단순하고 빠르다.

키는 RDB에서 PK에 해당한다.

키 자체도 유의미한 데이터임.

다른 유형보다 수평적 확장이 쉽다.

빠른 데이터 액세스와 처리 속도를 보장해 준다.

RDBMS와는 다르게 인메모리이기 때문에 모든 데이터가 메모리에서 관리됨.

디스크 접근이 필요없기 때문에 데이터 처리 성능이 굉장히 빠르다.

하지만 싱글스레드에서 동작하는 경우 오래 걸리는 작업을 실행한 경우에는 그 쿼리가 완료되야 다음 쿼리가 실행되기때문에 주의해 사용해야함.

고가용성을 제공함.

센티널은 장애 상황을 탐지해 자동으로 페일오버 시킴. 
? 센티널? 공부
? 페일오버? 공부

레디스는 쉬운 수평적 확장이 가능하다.

### 데이터 저장소로서의 레디스

메모리에 있는 데이터는 영구 저장되지 않는다 하지만 AOF, RDB 형식으로 디스크에 주기적으로 저장할 수 있다. 그렇기에 장애가 발생해 데이터가 유실되도 백업 파일을 사용해 복구할수있음.

### 메시지 브로커로서의 레디스

레디스를 저장소로만 사용하는게아니라 서비스 간 메시지를 전달하는 메시지 브로커로 사용 할 수 있음.

그건 레디스의 pub/sub 기능 덕이다.

굉장히 빠르게 동작하고 간단하게 사용 가능하다.

pub/sub은 1회성이며 1개의 채널에 데이터를 던지면 이 채널을 듣고 있는 모든 소비자는 데이터를 빠르게 가져갈 수 있음.

레디스의 list 자료구조는 메시징 큐로 사용하기 알맞다.

push/pop을 할 수 있음.

데이터가 없을때 대기하다 새로운 데이터가 오면 읽어 갈 수 있는 블로킹 기능을 사용할 수 도있음.

stream자료 구조를 사용하면 레디스를 완벽히 스트림 플랫폼으로 사용할수있음.

stream 자료 구조는 카프카를 본딴것임.

그렇기에 컨슈머와 퍼블리셔도 존재함. 분산처리도 가능함.
# 레디스에서 키를 관리하는 법

## 키의 자동 생성과 삭제

stream, set, sorted set, hash 와 같이 하나의 키가 여러개의 아이템을 가지고 있는 자료 구조에서는 명시적으로 키를 생성하거나 삭제하지 않아도 키는 알아서 생성되고 삭제 된다. 키의 생성과 삭제는 세 가지 공통적인 규칙을 따른다.

1) 키가 존재하지 않을 때 아이템을 넣으면 아이템을 삽입하기 전에 빈 자료 구조를 생성한다.
2) 모든 아이템을 삭제하면 키도 자동으로 삭제된다. (단 stream은 예외)
3) 키가 없는 상태에서 키 삭제, 아이템 삭제, 자료 구조 크기 조회 같은 읽기 전용 커맨드를 수행하면 에러를 반환하는 대신 키가 있으나 아이템이 없는 것처럼 동작 한다
